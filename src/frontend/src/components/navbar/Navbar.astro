---
import { menuConfig } from '@config/menu'
import ThemeSelector from './ThemeSelector.svelte'
import { Icon } from 'astro-icon/components'

const mainMenuItems = menuConfig.main
---

<script>
  document.addEventListener('astro:page-load', () => {
    // Update active state for navigation links
    const currentPath = window.location.pathname
    const navLinks = document.querySelectorAll('.nav-link')

    navLinks.forEach((link) => {
      const href = link.getAttribute('href')
      if (href === currentPath || (currentPath === '/' && href === '/')) {
        link.classList.add('active')
      } else {
        link.classList.remove('active')
      }
    })

    // Hamburger menu functionality
    const hamburger = document.getElementById('hamburger')
    const mobileMenu = document.getElementById('mobile-menu')
    const body = document.body

    hamburger?.addEventListener('click', () => {
      const isOpen = mobileMenu?.classList.toggle('open')
      hamburger?.classList.toggle('open')
      if (isOpen) {
        body.style.overflow = 'hidden'
      } else {
        body.style.overflow = 'auto'
      }
    })

    // Close menu when clicking a link
    const menuLinks = mobileMenu?.querySelectorAll('a')
    menuLinks?.forEach((link) => {
      link.addEventListener('click', () => {
        mobileMenu?.classList.remove('open')
        hamburger?.classList.remove('open')
        body.style.overflow = 'auto'
      })
    })
  })
</script>

<nav>
  <div class='nav-container'>
    <!-- Logo/Brand -->
    <div class='logo'>
      <a href='/' class='logo-link'>
        <svg
          class='logo-icon'
          version='1.0'
          xmlns='http://www.w3.org/2000/svg'
          viewBox='0 0 300.000000 300.000000'
          preserveAspectRatio='xMidYMid meet'
        >
          <g
            transform='translate(0.000000,300.000000) scale(0.100000,-0.100000)'
            fill='currentColor'
            stroke='none'
          >
            <path
              d='M1415 2684 c-11 -2 -45 -9 -75 -15 -240 -49 -510 -327 -510 -525 0
-39 5 -51 33 -79 21 -21 48 -36 73 -41 36 -7 137 5 176 21 13 5 20 -5 37 -50
26 -68 27 -137 4 -176 -10 -17 -64 -61 -119 -100 -177 -122 -256 -226 -283
-374 -22 -116 -10 -209 43 -333 34 -77 32 -62 -4 46 -47 140 -38 267 26 393
36 73 93 125 224 206 127 79 161 110 184 165 27 63 21 94 -41 236 -3 6 2 12
10 12 8 0 24 -23 37 -52 31 -71 80 -270 80 -322 0 -136 -92 -230 -315 -322
-87 -36 -139 -84 -155 -144 -10 -38 -9 -56 10 -132 29 -117 28 -121 -101 -303
-14 -20 -9 -17 16 10 49 54 100 132 114 178 11 33 10 47 -9 110 -34 110 -18
172 58 223 17 12 82 39 143 60 211 72 295 153 314 301 6 43 3 57 -25 113 -30
59 -80 229 -80 271 0 17 13 18 216 18 l216 0 -6 -24 c-38 -152 3 -288 148
-490 141 -196 171 -324 94 -410 -17 -20 -71 -56 -122 -82 -104 -54 -181 -120
-207 -178 -24 -52 -24 -162 -1 -231 21 -59 70 -143 113 -194 37 -42 28 -24
-23 49 -46 66 -75 140 -83 217 -15 133 41 211 212 295 111 54 165 95 187 138
53 104 15 231 -142 470 -45 68 -91 149 -103 180 -27 71 -35 154 -20 209 10 36
16 42 38 42 22 0 24 -3 19 -22 -4 -13 -9 -56 -13 -95 -11 -132 21 -179 200
-297 64 -42 131 -94 150 -116 81 -95 76 -237 -18 -437 -24 -51 -42 -93 -40
-93 2 0 22 33 44 72 59 107 94 219 95 303 1 125 -49 197 -237 340 -131 100
-153 148 -126 275 6 27 11 50 12 50 1 0 24 -7 51 -15 148 -45 256 16 241 137
-26 210 -294 459 -542 503 -74 14 -174 17 -218 9z m255 -41 c115 -31 255 -123
328 -215 38 -48 73 -113 91 -171 7 -20 16 -35 21 -32 15 9 32 -61 23 -97 -10
-39 -61 -70 -108 -66 -26 3 -30 6 -27 31 6 60 -71 136 -124 123 -34 -9 -104
-74 -104 -97 0 -27 -27 -35 -48 -16 -15 14 -50 16 -229 16 -196 0 -212 -1
-228 -19 -20 -22 -39 -17 -30 9 5 18 -34 67 -78 95 -36 24 -79 13 -118 -31
-27 -31 -30 -42 -26 -75 5 -38 5 -38 -29 -38 -42 0 -89 23 -104 49 -20 39 -7
123 17 108 6 -4 17 20 26 52 42 149 216 315 389 370 97 32 253 33 358 4z
m-508 -488 c16 -14 36 -25 44 -25 8 0 14 -4 14 -8 0 -7 -133 -32 -168 -32 -23
0 -12 38 19 64 38 32 53 33 91 1z m764 7 c29 -23 47 -59 34 -67 -13 -8 -170
17 -170 27 0 4 6 8 14 8 8 0 24 11 37 25 28 29 56 31 85 7z'
            ></path>
            <path
              d='M1376 2609 c-94 -38 -203 -134 -265 -233 -40 -65 -40 -93 0 -46 l29
35 24 -30 25 -30 71 74 c91 93 139 116 240 116 98 0 151 -25 239 -110 37 -36
73 -65 79 -65 6 0 18 10 26 22 17 23 18 23 54 -26 29 -38 28 -14 -3 53 -47
100 -199 227 -305 255 -14 3 4 -8 40 -26 95 -47 154 -110 179 -193 12 -38 20
-70 17 -72 -2 -2 -15 16 -29 40 -34 57 -87 103 -157 136 -74 35 -201 37 -272
4 -60 -27 -140 -102 -168 -156 l-22 -42 6 43 c15 104 96 199 209 246 34 14 55
25 47 25 -8 0 -37 -9 -64 -20z'
            ></path>
            <path
              d='M1223 2550 c-113 -74 -229 -188 -271 -268 -18 -33 -32 -63 -32 -66 0
-18 23 1 61 52 53 71 62 78 69 49 5 -18 12 -10 37 45 38 81 107 158 188 209
33 22 55 39 49 39 -6 0 -51 -27 -101 -60z'
            ></path>
            <path
              d='M1741 2572 c68 -44 144 -133 171 -202 24 -62 38 -76 38 -39 0 19 2
20 16 8 9 -7 36 -39 61 -71 50 -65 70 -75 49 -23 -41 96 -160 225 -283 306
-42 27 -80 49 -86 49 -6 0 9 -13 34 -28z'
            ></path>
            <path
              d='M1320 2042 c0 -4 11 -45 23 -92 33 -118 75 -195 152 -280 37 -40 73
-87 81 -106 47 -112 -19 -218 -222 -360 -107 -75 -134 -109 -134 -172 0 -48
13 -76 76 -172 65 -97 73 -178 29 -284 -25 -59 -11 -54 16 6 15 36 24 78 27
128 3 73 2 77 -39 144 -50 82 -58 131 -35 209 21 73 53 109 154 174 146 94
211 178 212 271 0 58 -15 89 -102 218 -74 108 -110 190 -124 282 l-7 42 -53 0
c-30 0 -54 -3 -54 -8z m93 -122 c9 -30 27 -76 40 -101 13 -26 18 -45 11 -42
-22 8 -84 156 -84 203 0 27 18 -4 33 -60z'
            ></path>
            <path
              d='M1468 2044 c-10 -9 30 -140 59 -197 14 -29 45 -82 69 -120 93 -143
116 -214 94 -281 -7 -22 -49 -76 -102 -134 -104 -112 -144 -167 -169 -231 -56
-148 -26 -272 116 -476 34 -49 70 -104 79 -122 28 -56 19 -110 -27 -161 -11
-12 -15 -22 -9 -22 7 0 25 19 42 42 52 72 42 124 -56 279 -105 166 -131 298
-79 404 29 60 47 80 145 164 136 115 179 185 180 287 0 77 -18 128 -75 214
-25 38 -55 90 -66 116 -26 57 -35 154 -21 207 l10 37 -92 0 c-51 0 -95 -3 -98
-6z m132 -93 c0 -82 31 -174 86 -256 68 -100 84 -141 84 -211 0 -84 -33 -148
-117 -222 -36 -31 -88 -77 -114 -101 -94 -84 -39 2 86 134 66 71 100 126 109
176 9 54 -24 147 -88 248 -73 115 -117 206 -124 253 l-5 38 42 0 41 0 0 -59z'
            ></path>
            <path
              d='M1446 1611 c-19 -143 -65 -222 -165 -281 -87 -52 -148 -111 -173
-168 -12 -26 -25 -95 -33 -169 -10 -82 -21 -140 -35 -168 -19 -40 -81 -105
-160 -168 -19 -15 -8 -10 25 11 74 49 130 109 155 168 11 24 26 92 34 152 9
59 22 125 31 145 23 54 79 106 175 159 124 68 177 126 216 235 l18 50 -33 42
c-18 22 -36 41 -41 41 -4 0 -10 -22 -14 -49z'
            ></path>
          </g>
        </svg>
        <span>AI Tools</span>
      </a>
    </div>

    <!-- Desktop navigation -->
    <ul class='desktop-nav'>
      {
        mainMenuItems.map((item) => (
          <li>
            <a href={item.href} class='nav-link' id={item.id || undefined}>
              {item.icon && <Icon name={item.icon} width='20' height='20' />}
              <span>{item.label}</span>
            </a>
          </li>
        ))
      }
      <li class='theme-selector-item'>
        <ThemeSelector client:load />
      </li>
    </ul>

    <!-- Mobile hamburger button -->
    <button id='hamburger' class='hamburger' aria-label='Toggle menu'>
      <span></span>
      <span></span>
      <span></span>
    </button>

    <!-- Mobile menu -->
    <div id='mobile-menu' class='mobile-menu'>
      <ul>
        {
          mainMenuItems.map((item) => (
            <li>
              <a href={item.href} class='nav-link' id={item.id || undefined}>
                {item.icon && <Icon name={item.icon} width='20' height='20' />}
                <span>{item.label}</span>
              </a>
            </li>
          ))
        }
        <li class='theme-selector-item mobile-theme-selector'>
          <ThemeSelector client:load />
        </li>
      </ul>
    </div>
  </div>
</nav>

<style>
  nav {
    width: 100%;
    background-color: var(--bg-primary, #fff);
    border-bottom: 1px solid var(--border-color, #e0e0e0);
    position: sticky;
    top: 0;
    z-index: 100;
    transition:
      background-color 0.3s ease,
      border-color 0.3s ease;
  }

  .nav-container {
    margin: 0 auto;
    padding: 1rem 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .logo {
    font-size: 1.5rem;
    font-weight: 700;
  }

  .logo-link {
    text-decoration: none;
    color: var(--text-primary, #100f0f);
    transition: color 0.2s;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .logo-link:hover {
    color: var(--accent-color, #b12424);
  }

  .logo-icon {
    width: 48px;
    height: 48px;
    flex-shrink: 0;
  }

  .desktop-nav {
    display: none;
    list-style: none;
    margin: 0;
    padding: 0;
    gap: 2rem;
    align-items: center;
  }

  .desktop-nav li {
    margin: 0;
  }

  .theme-selector-item {
    display: flex;
    align-items: center;
  }

  .mobile-theme-selector {
    padding: 1rem 2rem;
    border-bottom: 1px solid var(--border-color, #e0e0e0);
  }

  .nav-link {
    text-decoration: none;
    color: var(--text-secondary, #666);
    font-size: 1rem;
    font-weight: 500;
    padding: 0.5rem 0;
    transition: color 0.2s;
    position: relative;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .nav-link:hover {
    color: var(--accent-color, #b12424);
  }

  .nav-link.active {
    color: var(--accent-color, #b12424);
  }

  .nav-link.active::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    height: 2px;
    background-color: var(--accent-color, #b12424);
  }

  /* Hamburger menu button - mobile only */
  .hamburger {
    display: flex;
    flex-direction: column;
    justify-content: space-around;
    width: 2rem;
    height: 2rem;
    background: transparent;
    border: none;
    cursor: pointer;
    padding: 0;
    z-index: 1001;
  }

  .hamburger span {
    width: 2rem;
    height: 0.25rem;
    background: var(--text-primary, #333);
    border-radius: 10px;
    transition: all 0.3s linear;
    position: relative;
    transform-origin: 1px;
  }

  .hamburger.open span:nth-child(1) {
    transform: rotate(45deg);
  }

  .hamburger.open span:nth-child(2) {
    opacity: 0;
    transform: translateX(20px);
  }

  .hamburger.open span:nth-child(3) {
    transform: rotate(-45deg);
  }

  /* Mobile menu */
  .mobile-menu {
    position: fixed;
    top: 0;
    right: -100%;
    width: 80%;
    max-width: 300px;
    height: 100vh;
    background: var(--bg-primary, #fff);
    box-shadow: -2px 0 10px var(--shadow, rgba(0, 0, 0, 0.1));
    transition:
      right 0.3s ease-in-out,
      background-color 0.3s ease;
    z-index: 1000;
    overflow-y: auto;
    padding-top: 4rem;
  }

  .mobile-menu.open {
    right: 0;
  }

  .mobile-menu ul {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
  }

  .mobile-menu li {
    width: 100%;
    border-bottom: 1px solid var(--border-color, #e0e0e0);
  }

  .mobile-menu .nav-link {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem 2rem;
    color: var(--text-primary, #333);
    font-size: 1.1rem;
  }

  .mobile-menu .nav-link:hover {
    background-color: var(--bg-secondary, #f5f5f5);
  }

  .mobile-menu .nav-link.active {
    background-color: var(--bg-secondary, #f5f5f5);
  }

  .mobile-menu .nav-link.active::after {
    display: none;
  }

  /* Tablet and desktop styles */
  @media screen and (min-width: 768px) {
    .nav-container {
      padding: 1rem 2rem;
    }

    .desktop-nav {
      display: flex;
    }

    .hamburger {
      display: none;
    }

    .mobile-menu {
      display: none;
    }
  }
</style>
